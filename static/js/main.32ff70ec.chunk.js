(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{126:function(e,t,a){e.exports=a(185)},185:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),s=a.n(c),o=a(237),i=a(236),l=a(51),u=a.n(l),m=a(75),f=a(27),p=a(98),d=a(99),h=a(115),v=a(226),y=a(247),E=Object(v.a)((function(e){return Object(y.a)({previewChip:{minWidth:160,maxWidth:210},dropzoneRoot:{display:"flex",flexDirection:"column",justifyContent:"center"}})}));function b(e){var t=E(),a=e.multiple,n=e.onChange;return r.a.createElement(h.a,{fileObjects:[],filesLimit:a?100:1,onDrop:n,showPreviews:!1,showPreviewsInDropzone:!1,dropzoneClass:t.dropzoneRoot,showAlerts:["error"]})}var w=a(111),g=a.n(w),k=a(112),j=a.n(k),O=a(245),x=a(234),F=a(241),S=a(225),N=a(227),C=a(228),P=a(229),A=a(230),_=a(238),M=a(244),D=a(248),z=a(242),R=a(231),I=a(240),W=a(232),B=a(235),T=a(243),U=a(239),H=a(233),J=a(113),q=a.n(J),L=a(114),Y=a.n(L),$=a(78),X=a.n($),G=a(77),K=a.n(G),Q=Object(v.a)((function(e){return Object(y.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},fileCheckbox:{minWidth:"auto",paddingRight:e.spacing(1)},radioArea:{backgroundColor:"#fff",width:"100%",padding:e.spacing(2)},step:{"&$completed":{color:"#09af00"}},completed:{}})})),V=["Upload remix bundle","Upload source PDFs","Select style","Remix PDF"];var Z=function(){function e(t){var a=this;Object(p.a)(this,e),this._sourcesFilesMap={},void 0===t&&(t=[]),t.forEach((function(e){a._sourcesFilesMap[e.fileName]={source:e}}))}return Object(d.a)(e,[{key:"clone",value:function(){var t=new e([]);for(var a in this._sourcesFilesMap)t._sourcesFilesMap[a]=Object.assign({},this._sourcesFilesMap[a]);return t}},{key:"addFile",value:function(e){if(void 0===this._sourcesFilesMap[e.name])throw new Error("".concat(e.name," is not one of the required source PDF files"));this._sourcesFilesMap[e.name].file=e}},{key:"isFilePresent",value:function(e){return void 0!==this._sourcesFilesMap[e].file}},{key:"areAllFilesPresent",value:function(){for(var e in this._sourcesFilesMap)if(!this.isFilePresent(e))return!1;return!0}},{key:"fileNames",get:function(){return Object.keys(this._sourcesFilesMap)}},{key:"files",get:function(){var e=[];for(var t in this._sourcesFilesMap){var a=this._sourcesFilesMap[t].file;if(void 0===a)throw new Error("required file ".concat(t," is missing"));e.push(a)}return e}}]),e}();function ee(e){var t={sources:[],styles:[]};if(!(e instanceof Object))throw new Error("manifest is not an object");var a=e;if(!(a.sources instanceof Array))throw new Error("manifest is missing sources key");if(a.sources.forEach((function(e){return t.sources.push(function(e){var t={url:"",fileName:"",md5sum:""};try{t.fileName=te(e.file_name)}catch(a){throw new Error("".concat(JSON.stringify(t),"\n").concat(a))}try{t.url=te(e.url)}catch(a){throw new Error("".concat(t.fileName," url: ").concat(a))}try{t.md5sum=te(e.md5sum)}catch(a){throw new Error("".concat(t.fileName," md5sum: ").concat(a))}return t}(e))})),!(a.styles instanceof Array))throw new Error("manifest is missing style key");return a.styles.forEach((function(e){return t.styles.push(function(e){var t={name:"",description:"",styleSheet:""};try{t.name=te(e.name)}catch(a){throw new Error("".concat(JSON.stringify(e),"\n").concat(a))}try{t.description=te(e.description)}catch(a){throw new Error("".concat(t.name," description: ").concat(a))}try{t.styleSheet=te(e.style_sheet)}catch(a){throw new Error("".concat(t.name," stylesheet: ").concat(a))}return t}(e))})),t}function te(e){if("string"===typeof e)return e;throw new Error(e+" is not a string")}var ae=function(e){var t=Q(),a=r.a.useState(0),c=Object(f.a)(a,2),s=c[0],o=c[1],i=Object(n.useState)(""),l=Object(f.a)(i,2),p=l[0],d=l[1],h=Object(n.useState)(),v=Object(f.a)(h,2),y=v[0],E=v[1],w=Object(n.useState)(0),k=Object(f.a)(w,2),J=k[0],L=k[1],$=Object(n.useState)(null),G=Object(f.a)($,2),te=G[0],ae=G[1],ne=Object(n.useState)([]),re=Object(f.a)(ne,2),ce=re[0],se=re[1],oe=Object(n.useState)(),ie=Object(f.a)(oe,2),le=ie[0],ue=ie[1],me=Object(n.useState)(new Z),fe=Object(f.a)(me,2),pe=fe[0],de=fe[1],he=function(){o(0),d(""),E(void 0),L(0),ae(null),se([]),ue(void 0),de(new Z)},ve=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,c,i,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t[0],e.prev=1,e.next=4,q.a.loadAsync(a);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),ue({severity:"error",message:a.name+" is not a valid zip file"}),e.abrupt("return");case 11:if(null!==(l=n.file("manifest.yml"))){e.next=15;break}return ue({severity:"error",message:"Invalid patch bundle, does not contain manifest.yml"}),e.abrupt("return");case 15:return e.prev=15,e.next=18,l.async("text");case 18:r=e.sent,i=Y.a.safeLoad(r),e.next=27;break;case 22:return e.prev=22,e.t1=e.catch(15),console.error(e.t1),ue({severity:"error",message:"Could not read manifest.yml in zip file"}),e.abrupt("return");case 27:e.prev=27,c=ee(i),e.next=35;break;case 31:return e.prev=31,e.t2=e.catch(27),ue({severity:"error",message:"error parsing manifest: "+e.t2.toString()}),e.abrupt("return");case 35:se(c.styles),de(new Z(c.sources)),E(a),o(s+1);case 39:case"end":return e.stop()}}),e,null,[[1,7],[15,22],[27,31]])})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=pe.clone(),n=[],t.forEach((function(e){try{a.addFile(e)}catch(t){n.push(t.toString())}})),!(n.length>0)){e.next=6;break}return ue({severity:"error",message:n.join(", ")}),e.abrupt("return");case 6:return de(a),e.next=9,new Promise((function(e){return setTimeout(e,50)}));case 9:a.areAllFilesPresent()&&o(s+1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){be()?o(s+1):console.warn("PatchStepper#handleNext was called when step wasn't complete.")},be=function(){return!!(0===s&&void 0!==y||1===s&&pe.areAllFilesPresent()||2===s&&""!==p||3===s&&(100===J||te))},we=Object(n.useCallback)((function(){if(void 0!==y){ae(null);var t=new FormData;return t.set("cssName",p),t.append("bundle",y),pe.files.forEach((function(e){return t.append("pdfs",e)})),g.a.post("".concat(e.remixApiHost,"/api/v0/patch"),t,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then((function(e){j()(e.data,"patched.pdf"),L(100)})).catch((function(e){e.response.data.text().then((function(e){ae(e)}))}))}console.warn("tried to submitPdfPatch without bundleFile")}),[y,p,pe,e.remixApiHost]);return Object(n.useEffect)((function(){3!==s||0!==J||te||(L(1),we())}),[s,J,te,we]),r.a.createElement("div",{className:t.root},r.a.createElement(O.a,{activeStep:s},V.map((function(e,a){return r.a.createElement(x.a,{completed:s>a||3===a&&100===J,key:e},r.a.createElement(F.a,{error:!(3!==a||!te),StepIconProps:{classes:{root:t.step,completed:t.completed}}},e))}))),r.a.createElement(B.a,{maxWidth:"md"},r.a.createElement(_.a,{my:4},r.a.createElement(S.a,{disabled:0===s||3===s,onClick:function(){o(s-1)},className:t.button},"Back"),function(){switch(s){case 0:case 1:case 2:return r.a.createElement(S.a,{variant:"contained",color:"primary",onClick:(e=s,e===V.length-1?he:Ee),className:t.button,disabled:!be()},2===s?"Remix":"Next");case 3:return r.a.createElement(S.a,{variant:"contained",color:"secondary",onClick:he,className:t.button,disabled:!be()},"Start Over");default:return console.error("Unexpected step while getting action button"),null}var e}()),r.a.createElement(_.a,{m:1},function(e){switch(e){case 0:return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,{key:"patch-bundle-dropper",multiple:!1,onChange:ve}),r.a.createElement(N.a,{dense:!0},r.a.createElement(C.a,null,r.a.createElement(P.a,{className:t.fileCheckbox},y?r.a.createElement(K.a,null):r.a.createElement(X.a,null)),r.a.createElement(A.a,null,"REMIX BUNDLE (",y?y.name:".zip",")"))));case 1:return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,{key:"pdf-dropper",multiple:!0,onChange:ye}),r.a.createElement(N.a,{dense:!0},pe.fileNames.map((function(e){return r.a.createElement(C.a,{key:e},r.a.createElement(P.a,{className:t.fileCheckbox},pe.isFilePresent(e)?r.a.createElement(K.a,null):r.a.createElement(X.a,null)),r.a.createElement(A.a,null,e))}))));case 2:return r.a.createElement(_.a,{className:t.radioArea},r.a.createElement(M.a,null,r.a.createElement(D.a,null,"Style"),r.a.createElement(z.a,{"aria-label":"style",name:"style",className:t.radioArea,value:p,onChange:function(e){return d(e.target.value)}},ce.map((function(e){return r.a.createElement(R.a,{key:e.styleSheet,value:e.styleSheet,control:r.a.createElement(I.a,null),label:e.name})})))));case 3:return te?r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{variant:"determinate",value:100}),r.a.createElement(U.a,{severity:"error"},r.a.createElement(H.a,null,"Error"),te,r.a.createElement("br",null),"You can start over, fix this error, and then retry. If the error persists, contact the author of this remix.")):J<100?r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,null),r.a.createElement(U.a,{severity:"info"},r.a.createElement(H.a,null,"Patching in progress"),"This may take up to a minute.")):r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{variant:"determinate",value:100}),r.a.createElement(U.a,{severity:"success"},r.a.createElement(H.a,null,"Success"),"Your patched PDF is downloading now."));default:return console.error("Unexpected step while rendering step"),null}}(s))),r.a.createElement(T.a,{open:!!le,autoHideDuration:6e3,onClose:function(){return ue(void 0)}},le&&r.a.createElement(U.a,{severity:le.severity,onClose:function(){return ue(void 0)}},le.message)))};var ne=function(){var e="https://pdfpatch-gyeisy4svq-nn.a.run.app";return r.a.createElement(ae,{remixApiHost:e})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var re=a(71),ce=a(116),se=Object(ce.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:re.a.A400},background:{default:"#f4f4f4"}}});s.a.render(r.a.createElement(i.a,{theme:se},r.a.createElement(o.a,null),r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[126,1,2]]]);
//# sourceMappingURL=main.32ff70ec.chunk.js.map