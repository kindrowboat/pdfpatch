(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{126:function(e,t,a){e.exports=a(185)},185:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(11),c=a.n(s),i=a(237),o=a(236),l=a(51),u=a.n(l),m=a(75),f=a(27),p=a(98),d=a(99),h=a(115),v=a(226),b=a(247),E=Object(v.a)((function(e){return Object(b.a)({previewChip:{minWidth:160,maxWidth:210},dropzoneRoot:{display:"flex",flexDirection:"column",justifyContent:"center"}})}));function y(e){var t=E(),a=e.multiple,n=e.onChange;return r.a.createElement(h.a,{fileObjects:[],filesLimit:a?100:1,onDrop:n,showPreviews:!1,showPreviewsInDropzone:!1,dropzoneClass:t.dropzoneRoot,showAlerts:["error"]})}var g=a(111),w=a.n(g),k=a(112),j=a.n(k),F=a(245),O=a(234),x=a(241),S=a(225),C=a(227),P=a(228),N=a(229),_=a(230),M=a(238),A=a(244),D=a(248),z=a(242),R=a(231),I=a(240),W=a(232),B=a(235),T=a(243),U=a(239),q=a(233),L=a(113),J=a.n(L),Y=a(114),$=a.n(Y),H=a(78),X=a.n(H),G=a(77),K=a.n(G),Q=Object(v.a)((function(e){return Object(b.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},fileCheckbox:{minWidth:"auto",paddingRight:e.spacing(1)},radioArea:{backgroundColor:"#fff",width:"100%",padding:e.spacing(2)},step:{"&$completed":{color:"#09af00"}},completed:{}})})),V=["Upload remix bundle","Upload source PDFs","Select style","Remix PDF"];var Z=function(){function e(t){var a=this;Object(p.a)(this,e),this._sourcesFilesMap={},void 0===t&&(t=[]),t.forEach((function(e){a._sourcesFilesMap[e.fileName]={source:e}}))}return Object(d.a)(e,[{key:"clone",value:function(){var t=new e([]);for(var a in this._sourcesFilesMap)t._sourcesFilesMap[a]=Object.assign({},this._sourcesFilesMap[a]);return t}},{key:"addFile",value:function(e){if(void 0===this._sourcesFilesMap[e.name])throw new Error("".concat(e.name," is not one of the required source PDF files"));this._sourcesFilesMap[e.name].file=e}},{key:"isFilePresent",value:function(e){return void 0!==this._sourcesFilesMap[e].file}},{key:"areAllFilesPresent",value:function(){for(var e in this._sourcesFilesMap)if(!this.isFilePresent(e))return!1;return!0}},{key:"fileNames",get:function(){return Object.keys(this._sourcesFilesMap)}},{key:"files",get:function(){var e=[];for(var t in this._sourcesFilesMap){var a=this._sourcesFilesMap[t].file;if(void 0===a)throw new Error("required file ".concat(t," is missing"));e.push(a)}return e}}]),e}();function ee(e){var t={sources:[],styles:[]};if(!(e instanceof Object))throw new Error("manifest is not an object");var a=e;if(!(a.sources instanceof Array))throw new Error("manifest is missing sources key");if(a.sources.forEach((function(e){return t.sources.push(function(e){var t={url:"",fileName:"",md5sum:""};return t.fileName=te(e.file_name),t.url=te(e.url),t.md5sum=te(e.md5sum),t}(e))})),!(a.styles instanceof Array))throw new Error("manifest is missing style key");return a.styles.forEach((function(e){return t.styles.push(function(e){var t={name:"",description:"",styleSheet:""};return t.name=te(e.name),t.description=te(e.description),t.styleSheet=te(e.style_sheet),t}(e))})),t}function te(e){if("string"===typeof e)return e;throw new Error(e+"is not a string")}var ae=function(){var e=Q(),t=r.a.useState(0),a=Object(f.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(""),o=Object(f.a)(i,2),l=o[0],p=o[1],d=Object(n.useState)(),h=Object(f.a)(d,2),v=h[0],b=h[1],E=Object(n.useState)(0),g=Object(f.a)(E,2),k=g[0],L=g[1],Y=Object(n.useState)(null),H=Object(f.a)(Y,2),G=H[0],te=H[1],ae=Object(n.useState)([]),ne=Object(f.a)(ae,2),re=ne[0],se=ne[1],ce=Object(n.useState)(),ie=Object(f.a)(ce,2),oe=ie[0],le=ie[1],ue=Object(n.useState)(new Z),me=Object(f.a)(ue,2),fe=me[0],pe=me[1],de=function(){c(0),p(""),b(void 0),L(0),te(null),se([]),le(void 0),pe(new Z)},he=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,i,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t[0],e.prev=1,e.next=4,J.a.loadAsync(a);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),le({severity:"error",message:a.name+" is not a valid zip file"}),e.abrupt("return");case 11:if(null!==(l=n.file("manifest.yml"))){e.next=15;break}return le({severity:"error",message:"Invalid patch bundle, does not contain manifest.yml"}),e.abrupt("return");case 15:return e.prev=15,e.next=18,l.async("text");case 18:r=e.sent,o=$.a.safeLoad(r),e.next=27;break;case 22:return e.prev=22,e.t1=e.catch(15),console.error(e.t1),le({severity:"error",message:"Could not read manifest.yml in zip file"}),e.abrupt("return");case 27:e.prev=27,i=ee(o),e.next=35;break;case 31:return e.prev=31,e.t2=e.catch(27),le({severity:"error",message:"error parsing manifest: "+e.t2.toString()}),e.abrupt("return");case 35:se(i.styles),pe(new Z(i.sources)),b(a),c(s+1);case 39:case"end":return e.stop()}}),e,null,[[1,7],[15,22],[27,31]])})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=fe.clone(),n=[],t.forEach((function(e){try{a.addFile(e)}catch(t){n.push(t.toString())}})),!(n.length>0)){e.next=6;break}return le({severity:"error",message:n.join(", ")}),e.abrupt("return");case 6:return pe(a),e.next=9,new Promise((function(e){return setTimeout(e,50)}));case 9:a.areAllFilesPresent()&&c(s+1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){Ee()?c(s+1):console.warn("PatchStepper#handleNext was called when step wasn't complete.")},Ee=function(){return!!(0===s&&void 0!==v||1===s&&fe.areAllFilesPresent()||2===s&&""!==l||3===s&&(100===k||G))},ye=Object(n.useCallback)((function(){if(void 0!==v){te(null);var e=new FormData;return e.set("cssName",l),e.append("bundle",v),fe.files.forEach((function(t){return e.append("pdfs",t)})),w.a.post("https://pdfpatch-gyeisy4svq-nn.a.run.app/api/v0/patch",e,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then((function(e){j()(e.data,"patched.pdf"),L(100)})).catch((function(e){e.response.data.text().then((function(e){te(e)}))}))}console.warn("tried to submitPdfPatch without bundleFile")}),[v,l,fe]);return Object(n.useEffect)((function(){3!==s||0!==k||G||(L(1),ye())}),[s,k,G,ye]),r.a.createElement("div",{className:e.root},r.a.createElement(F.a,{activeStep:s},V.map((function(t,a){return r.a.createElement(O.a,{completed:s>a||3===a&&100===k,key:t},r.a.createElement(x.a,{error:!(3!==a||!G),StepIconProps:{classes:{root:e.step,completed:e.completed}}},t))}))),r.a.createElement(B.a,{maxWidth:"md"},r.a.createElement(M.a,{my:4},r.a.createElement(S.a,{disabled:0===s||3===s,onClick:function(){c(s-1)},className:e.button},"Back"),function(){switch(s){case 0:case 1:case 2:return r.a.createElement(S.a,{variant:"contained",color:"primary",onClick:(t=s,t===V.length-1?de:be),className:e.button,disabled:!Ee()},2===s?"Remix":"Next");case 3:return r.a.createElement(S.a,{variant:"contained",color:"secondary",onClick:de,className:e.button,disabled:!Ee()},"Start Over");default:return console.error("Unexpected step while getting action button"),null}var t}()),r.a.createElement(M.a,{m:1},function(t){switch(t){case 0:return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,{key:"patch-bundle-dropper",multiple:!1,onChange:he}),r.a.createElement(C.a,{dense:!0},r.a.createElement(P.a,null,r.a.createElement(N.a,{className:e.fileCheckbox},v?r.a.createElement(K.a,null):r.a.createElement(X.a,null)),r.a.createElement(_.a,null,"REMIX BUNDLE (",v?v.name:".zip",")"))));case 1:return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,{key:"pdf-dropper",multiple:!0,onChange:ve}),r.a.createElement(C.a,{dense:!0},fe.fileNames.map((function(t){return r.a.createElement(P.a,{key:t},r.a.createElement(N.a,{className:e.fileCheckbox},fe.isFilePresent(t)?r.a.createElement(K.a,null):r.a.createElement(X.a,null)),r.a.createElement(_.a,null,t))}))));case 2:return r.a.createElement(M.a,{className:e.radioArea},r.a.createElement(A.a,null,r.a.createElement(D.a,null,"Style"),r.a.createElement(z.a,{"aria-label":"style",name:"style",className:e.radioArea,value:l,onChange:function(e){return p(e.target.value)}},re.map((function(e){return r.a.createElement(R.a,{key:e.styleSheet,value:e.styleSheet,control:r.a.createElement(I.a,null),label:e.name})})))));case 3:return G?r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{variant:"determinate",value:100}),r.a.createElement(U.a,{severity:"error"},r.a.createElement(q.a,null,"Error"),G,r.a.createElement("br",null),"You can start over, fix this error, and then retry. If the error persists, contact the author of this remix.")):k<100?r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,null),r.a.createElement(U.a,{severity:"info"},r.a.createElement(q.a,null,"Patching in progress"),"This may take up to a minute.")):r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{variant:"determinate",value:100}),r.a.createElement(U.a,{severity:"success"},r.a.createElement(q.a,null,"Success"),"Your patched PDF is downloading now."));default:return console.error("Unexpected step while rendering step"),null}}(s))),r.a.createElement(T.a,{open:!!oe,autoHideDuration:6e3,onClose:function(){return le(void 0)}},oe&&r.a.createElement(U.a,{severity:oe.severity,onClose:function(){return le(void 0)}},oe.message)))};var ne=function(){return r.a.createElement(ae,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var re=a(71),se=a(116),ce=Object(se.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:re.a.A400},background:{default:"#f4f4f4"}}});c.a.render(r.a.createElement(o.a,{theme:ce},r.a.createElement(i.a,null),r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[126,1,2]]]);
//# sourceMappingURL=main.3de51a6d.chunk.js.map